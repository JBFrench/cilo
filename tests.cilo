
step "Simple Shell", {
     $ echo "From shell works"
}

step "Mixed Shell", {
    println "From groovy works"
    $ echo "From shell works"
}

step "Multiline Shell", {
    $ echo "Multiline:"
    $ echo "from-line1" \
    $      "from-line2" \
    $      "from-line3" \
}

step "Control Flow Shell", {
    $ ifStatement() {
    $   if $1; then
    $     echo "true"
    $   else
    $     echo "false"
    $   fi
    $ }
    $ ifStatement "true"
    $ ifStatement "false"
}

step "Shell Timing", {
    $ for i in `seq 1 10`; do
    $   sleep 0.2
    $   echo "Slept for $i second total."
    $ done
}

step "Shell Variable Access", {
    def variables = [
        "VAR_1":"groovy variable 1",
        "VAR_2":"groovy variable 2"
    ]
    env variables, {
        $ echo "Bash Var 1: $VAR_1"
        $ echo "Bash Var 2: $VAR_2"
    }
}

step "Shell Return Values", {
    $ echo "Some value from stdout."
    $ echo "Some value from stderr." 1>&2
    $ false
    println "STDOUT--: $stdOut"
    print   "STDERR--: $stdErr"
    println "EXITCODE: $exitCode (should be 1)"
    $ echo "Some other value from stdout."
    $ echo "Some other value from stderr." 1>&2
    $ true
    println "STDOUT--: $stdOut"
    print   "STDERR--: $stdErr"
    println "EXITCODE: $exitCode (should be 0)"
}

step "Variable Scope", {
    def outer = "Outer scope"
    def variables = [
        "VAR_1":"Groovy to shell variable",
    ]
    env variables, {
        def inner = "Inner scope"        
        println "Inner: ${outer}"
        println "Outer: ${inner}"
    }
}

step "Groovy Secret", {
     secret "username", {
            println "Secret------: ${username}"
            println "Secret Text-: ${usernameText}"
            println "Secret Bytes: ${usernameBytes}"
            println "Secret File-: ${usernameFile}"
     }
}

step "Bash Secret", {
     secret "password", {
            $ echo "From shell-------Secret: $password"
            $ echo "From shell--Secret Text: $passwordText"
            $ echo "From shell-Secret Bytes: $passwordBytes"
            $ echo "From shell--Secret File: $passwordFile"
     }
}

step "Nested Secrets", {
     secret "username", {
            secret "password", {
                   println "USERNAME: ${username}"
            $ echo "Password: ${password}"
            }
     }    
}

step "Secret Combined Variables", {
     def password = "itdoeswork86"
     secret "username", {
            println "Username from Secret--: $username"
            println "Password from Variable: $password"
     }    
}

step "Secret Scope", {
    def outer = "Outer scope"
    secret "username", {
        def inner = "Inner scope"
        println "Groovy Variable Outer: ${outer}"
        println "Groovy Variable Inner: ${inner}"
    }
}

step "Variable Scope Combos", {
    def innerVariables = [
        "VAR_INNER":"Groovy to shell inner variable",
    ]
    def outerVariables = [
        "VAR_OUTER":"Groovy to shell outer variable",
    ]
    def outer = "Outer scope"
    env outerVariables, {
        def middle1 = "Middle1 scope"
        secret "username", {
            def middle2 = "Middle2 scope"
            env innerVariables, {
                def middle3 = "Middle3 scope"
                secret "password", {
                    def inner = "Inner scope"
                    println "Groovy Variable Outer--: ${outer}"
                    println "Groovy Variable Middle1: ${middle1}"
                    println "Groovy Variable Middle2: ${middle2}"
                    println "Groovy Variable Middle3: ${middle3}"
                    println "Groovy Variable Inner--: ${inner}"
                    $ echo "Bash Var Inner-------: $VAR_INNER"
                    $ echo "Bash Var Outer-------: $VAR_OUTER"
                }
            }
        }
    }
}

